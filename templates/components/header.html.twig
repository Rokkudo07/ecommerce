<header class="site-header">
    <div class="header-container">
        <div class="header-logo">
            <a href="{{ path('home') }}" class="logo-link">
                <img src="{{ asset('images/logo-maisononeness.webp') }}" alt="Maison Oneness" class="logo-img">
            </a>
        </div>

        <button class="mobile-menu-toggle" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
        </button>

        <nav class="header-nav" id="header-nav">
            {% set navItems = navigationItems ?? get_navigation() %}
            {% if navItems|length > 0 %}
                {% for item in navItems %}
                    {% if item.isVisible %}
                        {% set hasChildren = item.children|length > 0 %}
                        
                        {% if item.type == 'dropdown_only' or hasChildren %}
                            <div class="nav-dropdown-wrapper">
                                <span class="nav-link">{{ item.label }}</span>
                                {% if hasChildren %}
                                    <ul class="nav-dropdown">
                                        {% for child in item.children %}
                                            {% if child.isVisible %}
                                                <li>
                                                    <a href="{{ child.url ?: '#' }}" 
                                                       class="nav-link{% if child.isExternal %} external{% endif %}"
                                                       {% if child.isExternal %}target="_blank" rel="noopener noreferrer"{% endif %}>
                                                        {{ child.label }}
                                                    </a>
                                                </li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        {% else %}
                            <a href="{{ item.url ?: '#' }}" 
                               class="nav-link{% if item.isExternal %} external{% endif %}"
                               {% if item.isExternal %}target="_blank" rel="noopener noreferrer"{% endif %}>
                                {{ item.label }}
                            </a>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            {% endif %}
        </nav>

        <div class="header-actions">
            <div class="language-selector">
                <span class="language-icon">üåê</span>
                <span class="language-text">English</span>
                <span class="language-chevron">‚ñº</span>
            </div>
            
            {% if app.user %}
                <div class="user-menu-wrapper">
                    <button class="user-menu-toggle" aria-label="User menu">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </button>
                    <div class="user-menu-dropdown">
                        <a href="{{ path('account') }}" class="user-menu-link">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            Mon compte
                        </a>
                        <form method="post" action="{{ path('logout') }}" class="user-menu-logout">
                            <input type="hidden" name="_token" value="{{ csrf_token('logout') }}">
                            <button type="submit" class="user-menu-link">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                    <polyline points="16 17 21 12 16 7"></polyline>
                                    <line x1="21" y1="12" x2="9" y2="12"></line>
                                </svg>
                                D√©connexion
                            </button>
                        </form>
                    </div>
                </div>
            {% else %}
                <a href="{{ path('login') }}" class="btn-login">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
                        <polyline points="10 17 15 12 10 7"></polyline>
                        <line x1="15" y1="12" x2="3" y2="12"></line>
                    </svg>
                    Connexion
                </a>
            {% endif %}
            
            <a href="#" class="btn-book">Book now</a>
        </div>
    </div>
</header>
